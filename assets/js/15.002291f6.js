(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{430:function(s,t,a){"use strict";a.r(t);var n=a(56),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"lnmp环境部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lnmp环境部署"}},[s._v("#")]),s._v(" LNMP环境部署")]),s._v(" "),a("p",[s._v("LNMP是指一组通常一 起使用来运行动态网站或者服务器的自由软件名称首字母缩写。L指Linux，N指Nginx，M一般指MySQL，也可以指MariaDB, P一般指PHP，也可以指Perl或Python。 可以在独立主机上轻松的安装LNMP生产环境。本案例主要介绍LNMP框架安装方法以及部署Discuz社区论坛应用。")]),s._v(" "),a("h2",{attrs:{id:"_1-安装操作系统"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装操作系统"}},[s._v("#")]),s._v(" 1. 安装操作系统")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("使用VMware workstation新建虚拟机")])]),s._v(" "),a("li",[a("p",[s._v("安装CentOS7.5系统，最小化安装，记得要选中开发工具(development tools)")])]),s._v(" "),a("li",[a("p",[s._v("安装bash-completion以便可以命令补全")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" bash-completion -y\n")])])])]),s._v(" "),a("li",[a("p",[s._v("安装vim等基础包")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" net-tools "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -y\n")])])])])]),s._v(" "),a("h2",{attrs:{id:"_2-系统初始化配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-系统初始化配置"}},[s._v("#")]),s._v(" 2.系统初始化配置")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("Linux 系统资源调配")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/security/limits.conf \n*               soft    nofile            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65535")]),s._v("\n*               soft    nofile            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65535")]),s._v("\n")])])])]),s._v(" "),a("li",[a("p",[s._v("修改主机名字")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ hostnamectl set-hostname www.lnmp.com\n")])])])]),s._v(" "),a("li",[a("p",[s._v("配置网络。设置固定IP地址，网关及DNS服务器地址")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ nmcli connection modify ens33 ipv4.addresses "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".154.137/24 ipv4.gateway "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".154.2 ipv4.dns "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".154.2 autoconnect "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n$ nmcli connection up ens33\nConnection successfully activated "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])])]),s._v(" "),a("li",[a("p",[s._v("关闭Selinux")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/selinux/config\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SELINUX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("disabled\n")])])])]),s._v(" "),a("li",[a("p",[s._v("yum源的配置，可以根据业务需求来安装epel、 nginx、 remi源，且修改配置参数。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" epel-release -y\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ivh http://rpms.remirepo.net/enterprise/remi-release-7.rpm\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" remi.repo\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("epel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("enabled")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])])])]),s._v(" "),a("li",[a("p",[s._v("DNS 解析域名设置")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/resolve.conf \nnameserver "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".154.2\nnameserver "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("202.106")]),s._v(".0.20\n")])])])])]),s._v(" "),a("h2",{attrs:{id:"_3-安装配置nginx网站服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-安装配置nginx网站服务器"}},[s._v("#")]),s._v(" 3. 安装配置Nginx网站服务器")]),s._v(" "),a("h3",{attrs:{id:"_3-1-安装nginx服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-安装nginx服务"}},[s._v("#")]),s._v(" 3.1 安装nginx服务")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("设置nginx yum源")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" yum-utils -y\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/yum.repos.d/nginx.repo \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("nginx-stable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx stable repo\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("baseurl")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://nginx.org/packages/centos/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$releasever")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$basearch")]),s._v("/\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gpgcheck")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("enabled")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gpgkey")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://nginx.org/keys/nginx_signing.key\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("nginx-mainline"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx mainline repo\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("baseurl")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://nginx.org/packages/mainline/centos/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$releasever")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$basearch")]),s._v("/\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gpgcheck")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("enabled")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gpgkey")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://nginx.org/keys/nginx_signing.key\n")])])])]),s._v(" "),a("li",[a("p",[s._v("安装nginx服务，会安装1.16.0版本")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" nginx -y\n")])])])]),s._v(" "),a("li",[a("p",[s._v("设置nginx开机启动并开启nginx服务")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" nginx\nCreated symlink from /etc/systemd/system/multi-user.target.wants/nginx.service to /usr/lib/systemd/system/nginx.service.\n$ systemctl start nginx\n$ systemctl status nginx\n● nginx.service - nginx - high performance web server\n   Loaded: loaded "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/usr/lib/systemd/system/nginx.service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" vendor preset: disabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   Active: active "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("running"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" since Tue "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-04-14 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":01:46 EDT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 6s ago\n     Docs: http://nginx.org/en/docs/\n  Process: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20355")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/sbin/nginx -c /etc/nginx/nginx.conf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("code"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("exited, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("status")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/SUCCESS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n Main PID: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20356")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   CGroup: /system.slice/nginx.service\n           ├─20356 nginx: master process /usr/sbin/nginx -c /etc/nginx/nginx.conf\n           └─20357 nginx: worker process\n\nApr "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":01:46 www.lnmp.com systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Starting nginx - high performance web server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nApr "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":01:46 www.lnmp.com systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Started nginx - high performance web server.\n")])])])]),s._v(" "),a("li",[a("p",[s._v("防火墙放行http服务")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ firewall-cmd --add-service"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http --permanent\nsuccess\n$ firewall-cmd --add-service"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http\nsuccess\n")])])])]),s._v(" "),a("li",[a("p",[s._v("测试是够可以访问nginx")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".154.137\n")])])]),a("p",[s._v("或者找个客户端，使用浏览器访问服务器地址")])])]),s._v(" "),a("h3",{attrs:{id:"_3-2-调整nginx配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-调整nginx配置文件"}},[s._v("#")]),s._v(" 3.2 调整nginx配置文件")]),s._v(" "),a("p",[s._v("(文件夹有default.conf和nginx.conf)")]),s._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("vim")]),s._v(" /etc/nginx/nginx.conf\nuser  nginx nginx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("worker_processes")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("worker_cpu_affinity")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("00000001")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("00000010")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("00000100")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("00001000")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("worker_rlimit_nofile")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65535")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("error_log")]),s._v("  /var/log/nginx/error.log warn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("pid")]),s._v("        /var/run/nginx.pid")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("events")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" epoll")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("worker_connections")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10240")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("http")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),s._v("       /etc/nginx/mime.types")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default_type")]),s._v("  application/octet-stream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server_names_hash_bucket_size")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("client_header_buffer_size")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2k")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("large_client_header_buffers")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4k")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("client_max_body_size")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8m")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("log_format")]),s._v("  main  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$remote_addr")]),s._v(" - "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$remote_user")]),s._v(" ["),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$time_local]")]),s._v(' "'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$request")]),s._v("\" '")]),s._v("\n                      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$status")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$body_bytes_sent")]),s._v(' "'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$http_referer")]),s._v("\" '")]),s._v("\n                      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\""),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$http_user_agent")]),s._v('" "'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$http_x_forwarded_for")]),s._v("\"'")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("access_log")]),s._v("  /var/log/nginx/access.log  main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sendfile")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("on")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("tcp_nopush")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("on")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("tcp_nodelay")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("on")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("keepalive_timeout")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_cache_path")]),s._v(" /etc/nginx/fastcgi_cache levels=1:2 keys_zone=TEST:10m inactive=5m")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_cache_key")]),s._v(" http://"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$host")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$request_uri")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_connect_timeout")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("300")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_send_timeout")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("300")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_read_timeout")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("300")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_buffer_size")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4k")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_buffers")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4k")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_busy_buffers_size")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8k")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_temp_file_write_size")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8k")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_cache")]),s._v(" TEST")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_cache_valid")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("302")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1h")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_cache_valid")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("301")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1d")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_cache_valid")]),s._v(" any "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1m")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_cache_min_uses")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_cache_use_stale")]),s._v(" error timeout invalid_header http_500")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("open_file_cache")]),s._v(" max=204800 inactive=20s")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("open_file_cache_min_uses")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("open_file_cache_valid")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30s")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("gzip")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("on")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("gzip_min_length")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1k")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("gzip_buffers")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16k")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("gzip_http_version")]),s._v(" 1.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("gzip_comp_level")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("gzip_types")]),s._v(" text/plain application/x-javascript text/css application/xml")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("gzip_vary")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("on")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),s._v(" /etc/nginx/conf.d/*.conf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("vim")]),s._v(" /etc/nginx/conf.d/default.conf\nserver")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("listen")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server_name")]),s._v("  www.lnmp.com")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#charset koi8-r;")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#access_log  /var/log/nginx/host.access.log  main;")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" /")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("root")]),s._v("   /usr/share/nginx/html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("index")]),s._v("  index.html index.htm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" /status")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("stub_status")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("on")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#error_page  404              /404.html;")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redirect server error pages to the static page /50x.html")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("error_page")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("502")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("503")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("504")]),s._v("  /50x.html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" = /50x.html")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("root")]),s._v("   /opt/nginx/html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" ~ .*/.(gif|jpg|gpeg|png|bmp|swf|js|css)$")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("expires")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30d")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# proxy the PHP scripts to Apache listening on 127.0.0.1:80")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#location ~ \\.php$ {")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    proxy_pass   http://127.0.0.1;")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#location ~ \\.php$ {")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    root           html;")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    fastcgi_pass   127.0.0.1:9000;")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    fastcgi_index  index.php;")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    include        fastcgi_params;")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# deny access to .htaccess files, if Apache's document root")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# concurs with nginx's one")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#location ~ /\\.ht {")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    deny  all;")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("ul",[a("li",[a("p",[s._v("由于更改了根目录，所以需要创建新的根目录")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /opt/nginx/html -p\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/share/nginx/html/* /opt/nginx/html/\n$ ll /opt/nginx/html/\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("494")]),s._v(" Apr "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":48 50x.html\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("612")]),s._v(" Apr "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":48 index.html\n")])])])]),s._v(" "),a("li",[a("p",[s._v("改变了服务配置文件，所以需要重新启动服务")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ nginx -t "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#检测配置文件语法是否有错误")]),s._v("\n$ systemctl restart nginx\n$ systemctl status nginx\n")])])])])]),s._v(" "),a("h2",{attrs:{id:"_4-安装配置mysql数据库服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-安装配置mysql数据库服务器"}},[s._v("#")]),s._v(" 4.安装配置MySQL数据库服务器")]),s._v(" "),a("p",[s._v("​\t\tMySQL是目前使用最受信赖和广泛使用的开源数据库平台。全球十大最受欢迎和高流量的网站中有10个依赖于MySQL。MySQL 8.0通过提供全面的改进建立在这一势头上，旨在使创新的DBA和开发人员能够在最新一代的开发框架和硬件上创建和部署下一代Web，嵌入式，移动和云/ SaaS/ PaaS/ DBaaS应用程序平台。MySQL 8.0亮点包括：")]),s._v(" "),a("ul",[a("li",[s._v("MySQL文档存储")]),s._v(" "),a("li",[s._v("交易数据字典")]),s._v(" "),a("li",[s._v("SQL角色")]),s._v(" "),a("li",[s._v("默认为utf8mb4")]),s._v(" "),a("li",[s._v("公用表表达式")]),s._v(" "),a("li",[s._v("窗口功能")]),s._v(" "),a("li",[s._v("以及更多")])]),s._v(" "),a("h3",{attrs:{id:"_4-1-安装mysql源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-安装mysql源"}},[s._v("#")]),s._v(" 4.1 安装mysql源")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("下载MySQL YUM 仓库：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm\n")])])])]),s._v(" "),a("li",[a("p",[s._v("安装MySQL YUM 仓库：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -Uvh mysql80-community-release-el7-3.noarch.rpm\n")])])])])]),s._v(" "),a("h3",{attrs:{id:"_4-2-安装mysql数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-安装mysql数据库"}},[s._v("#")]),s._v(" 4.2 安装mysql数据库")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("默认安装最新GA版MySQL")])]),s._v(" "),a("li",[a("p",[s._v("可以通过运行以下命令并检查其输出来验证是否已启用和禁用了正确的子存储库")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ yum repolist enabled "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" mysql\nRepository "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'epel'")]),s._v(" is missing name "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" configuration, using "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("\nRepository epel is listed "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" than once "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the configuration\nmysql-connectors-community/x86_64 MySQL Connectors Community                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("141")]),s._v("\nmysql-tools-community/x86_64      MySQL Tools Community                      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("105")]),s._v("\nmysql80-community/x86_64          MySQL "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.0")]),s._v(" Community Server                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("161")]),s._v("\n")])])])]),s._v(" "),a("li",[a("p",[s._v("安装MySQL")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ yum remove mariadb-libs -y\n$ yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" mysql-community-server -y\n$ systemctl start mysqld\n$ systemctl status mysqld\n● mysqld.service - MySQL Server\n   Loaded: loaded "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/usr/lib/systemd/system/mysqld.service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" vendor preset: disabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   Active: active "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("running"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" since Tue "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-04-14 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":18:59 EDT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 16s ago\n     Docs: man:mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n           http://dev.mysql.com/doc/refman/en/using-systemd.html\n Main PID: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21009")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   Status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Server is operational"')]),s._v("\n   CGroup: /system.slice/mysqld.service\n           └─21009 /usr/sbin/mysqld\n\nApr "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":18:55 www.lnmp.com systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Starting MySQL Server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nApr "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":18:59 www.lnmp.com systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Started MySQL Server.\n")])])])])]),s._v(" "),a("h3",{attrs:{id:"_4-3-mysql数据库初始化-从mysql-5-7开始"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-mysql数据库初始化-从mysql-5-7开始"}},[s._v("#")]),s._v(" 4.3 MySQL数据库初始化(从MySQL 5.7开始)")]),s._v(" "),a("p",[s._v("在服务器初始启动时，如果服务器的数据目录为空，则会发生以下情况：")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("服务器已初始化。")])]),s._v(" "),a("li",[a("p",[s._v("在数据目录中生成SSL证书和密钥文件。")])]),s._v(" "),a("li",[a("p",[s._v("该validate_ password插件安装并启用。")])]),s._v(" "),a("li",[a("p",[s._v("将'root'@'localhost 创建一个超级用户帐户。 设置超级用户的密码并将其存储在错误日志文件中。要显示它，请使用以下命令：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'temporary password'")]),s._v(" /var/log/mysqld.log\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-04-14T17:18:57.123362Z "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Note"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("MY-010454"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" A temporary password is generated "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" root@localhost: tqlbNLQ*v5j1\n")])])]),a("p",[s._v("○ 通过使用生成的临时密码登录并为超级用户帐户设置自定义密码，尽快更改root密码：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ mysql -uroot -ptqlbNLQ*v5j1\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入数据库后更改密码")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" alter user "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost'")]),s._v(" identified by "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Com.123456'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意: MySQL的validate_ password 插件默认安装。这将要求密码包含至少一个大写字母，一个小写字母，一个数字和一个特殊字符，并且密码总长度至少为8个字符。")]),s._v("\n")])])])])]),s._v(" "),a("h3",{attrs:{id:"_4-4-配置开机启动mysql服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-配置开机启动mysql服务"}},[s._v("#")]),s._v(" 4.4 配置开机启动mysql服务")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" mysqld\n$ systemctl restart mysqld\n$ systemctl status mysqld\n● mysqld.service - MySQL Server\n   Loaded: loaded "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/usr/lib/systemd/system/mysqld.service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" vendor preset: disabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   Active: active "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("running"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" since Wed "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-04-15 07:38:02 EDT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 6s ago\n     Docs: man:mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n           http://dev.mysql.com/doc/refman/en/using-systemd.html\n  Process: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21314")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStartPre")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/bin/mysqld_pre_systemd "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("code"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("exited, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("status")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/SUCCESS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n Main PID: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21338")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   Status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Server is operational"')]),s._v("\n   CGroup: /system.slice/mysqld.service\n           └─21338 /usr/sbin/mysqld\n\nApr "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 07:38:01 www.lnmp.com systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Starting MySQL Server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nApr "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 07:38:02 www.lnmp.com systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Started MySQL Server.\n")])])]),a("h2",{attrs:{id:"_5-安装配置php环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-安装配置php环境"}},[s._v("#")]),s._v(" 5. 安装配置PHP环境")]),s._v(" "),a("h3",{attrs:{id:"_5-1-安装php7的yum源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-安装php7的yum源"}},[s._v("#")]),s._v(" 5.1 安装php7的YUM源")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm\n")])])]),a("h3",{attrs:{id:"_5-2-安装php7-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-安装php7-2"}},[s._v("#")]),s._v(" 5.2 安装PHP7.2")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" php72w php72w-cli php72w-common php72w-gd php72w-ldap php72w-mbstring php72w-mcrypt php72w-mysql php72w-pdo -y\n")])])]),a("h3",{attrs:{id:"_5-3-安装php-fpm并启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-安装php-fpm并启动"}},[s._v("#")]),s._v(" 5.3 安装php-fpm并启动")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" php72w-fpm php72w-opcache -y\n$ systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" php-fpm\n$ systemctl start php-fpm\n$ systemctl status php-fpm\n● php-fpm.service - The PHP FastCGI Process Manager\n   Loaded: loaded "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/usr/lib/systemd/system/php-fpm.service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" vendor preset: disabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   Active: active "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("running"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" since Wed "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-04-15 08:23:23 EDT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 4s ago\n Main PID: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21961")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("php-fpm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   Status: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Ready to handle connections"')]),s._v("\n   CGroup: /system.slice/php-fpm.service\n           ├─21961 php-fpm: master process "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/etc/php-fpm.conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n           ├─21962 php-fpm: pool www\n           ├─21963 php-fpm: pool www\n           ├─21964 php-fpm: pool www\n           ├─21965 php-fpm: pool www\n           └─21966 php-fpm: pool www\n\nApr "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 08:23:23 www.lnmp.com systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Starting The PHP FastCGI Process Manager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nApr "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" 08:23:23 www.lnmp.com systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Started The PHP FastCGI Process Manager.\n")])])]),a("h3",{attrs:{id:"_5-4-调整php-fpm-配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-调整php-fpm-配置文件"}},[s._v("#")]),s._v(" 5.4 调整php-fpm 配置文件")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/php-fpm.d/www.conf\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("www"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nuser "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" nginx\ngroup "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" nginx\n")])])]),a("h3",{attrs:{id:"_5-5-调整nginx配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-5-调整nginx配置文件"}},[s._v("#")]),s._v(" 5.5 调整nginx配置文件")]),s._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("vi")]),s._v(" /etc/nginx/conf.d/default.conf \nlocation /")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("root")]),s._v("   /opt/nginx/html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("index")]),s._v("  index.php index.html index.htm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" ~ \\.php$")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("root")]),s._v("           /opt/nginx/html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_pass")]),s._v("   127.0.0.1:9000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_index")]),s._v("  index.php")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;")]),s._v("\n    \t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_param")]),s._v("  SCRIPT_FILENAME  "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$document_root")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$fastcgi_script_name")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),s._v("        fastcgi_params")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_cache")]),s._v(" TEST")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_cache_valid")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("300")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("302")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1h")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_cache_valid")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("301")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1d")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fastcgi_cache_valid")]),s._v(" any "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1m")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("h3",{attrs:{id:"_5-6-创建mysql数据库管理员"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-6-创建mysql数据库管理员"}},[s._v("#")]),s._v(" 5.6 创建MySQL数据库管理员")]),s._v(" "),a("p",[s._v("认证机制必须是mysql_native_ password；默认mysql8使用caching_sha2_ password的身份验证机制")]),s._v(" "),a("div",{staticClass:"language-mysql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("> create user 'dbadmin'@'%' identified with mysql_native_password by 'Com.123456';\n> grant all on *.* to 'dbadmin'@'%';\n> grant grant option on *.* to 'dbadmin'@'%';\n")])])]),a("h2",{attrs:{id:"_6-lnmp环境测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-lnmp环境测试"}},[s._v("#")]),s._v(" 6.LNMP环境测试")]),s._v(" "),a("h3",{attrs:{id:"_6-1-测试lnmp环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-测试lnmp环境"}},[s._v("#")]),s._v(" 6.1 测试LNMP环境")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" test.php \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("?php\nphpinfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n?"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),a("ul",[a("li",[s._v("在客户端访问 http://192.168.154.137/test.php")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://pic-onemue-cn.oss-cn-beijing.aliyuncs.com/docs/onemue1647249939bNb0fs.png",alt:"image-20200415204934448"}})]),s._v(" "),a("h3",{attrs:{id:"_6-2-测试是否可以连接mysql数据库文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-测试是否可以连接mysql数据库文件"}},[s._v("#")]),s._v(" 6.2 测试是否可以连接MySQL数据库文件")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" mysql_test.php \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("?PHP\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$conn")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysqli_connect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"localhost"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dbadmin"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Com.123456"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    if"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$conn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ok"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("else"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"error"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n?"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),a("ul",[a("li",[s._v("在客户端访问")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" http://192.168.154.137/mysql_test.php\nok\n")])])]),a("h2",{attrs:{id:"_7-部署开源论坛discuz"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-部署开源论坛discuz"}},[s._v("#")]),s._v(" 7. 部署开源论坛Discuz")]),s._v(" "),a("h3",{attrs:{id:"_7-1-下载discuz论坛文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-下载discuz论坛文件"}},[s._v("#")]),s._v(" 7.1 下载Discuz论坛文件")]),s._v(" "),a("p",[s._v("Discuz现在在gitee.com进行维护，地址为：http://gitee.com/ComsenzDiscuz/DiscuzX")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("下载文件")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://gitee.com/ComsenzDiscuz/DiscuzX/repository/archive/master.zip\n")])])])]),s._v(" "),a("li",[a("p",[s._v("解压并上传upload目录到网站根目录")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("unzip")]),s._v(" master.zip \n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" DiscuzX/\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\nreadme  README.md  upload  utility\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" upload/ /opt/nginx/html/\n")])])])])]),s._v(" "),a("h3",{attrs:{id:"_7-2-建立discuz论坛所用数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-建立discuz论坛所用数据库"}},[s._v("#")]),s._v(" 7.2 建立Discuz论坛所用数据库")]),s._v(" "),a("div",{staticClass:"language-mysql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("$ mysql -uroot -pCom.123456\nmysql> show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| mysql              |\n| performance_schema |\n| sys                |\n+--------------------+\n4 rows in set (0.01 sec)\n\nmysql> create database discuz;\nQuery OK, 1 row affected (0.01 sec)\n\nmysql> show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| discuz             |\n| information_schema |\n| mysql              |\n| performance_schema |\n| sys                |\n+--------------------+\n5 rows in set (0.00 sec)\n")])])]),a("h3",{attrs:{id:"_7-3-安装discuz论坛"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-安装discuz论坛"}},[s._v("#")]),s._v(" 7.3 安装Discuz论坛")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("在客户端使用浏览器打开网站地址：http://192.168.154.137/upload/install ，会显示以下安装界面：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://pic-onemue-cn.oss-cn-beijing.aliyuncs.com/docs/onemue1647249965xNvblf.png",alt:"image-20200415213847825"}})])]),s._v(" "),a("li",[a("p",[s._v("点击我同意")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://pic-onemue-cn.oss-cn-beijing.aliyuncs.com/docs/onemue1647249978WXjvuH.png",alt:"image-20200415214043019"}})])]),s._v(" "),a("li",[a("p",[s._v("解决所有文件权限，需要可写权限")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /opt/nginx/html/upload/\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" -R "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("777")]),s._v(" ./config/ ./data/ ./uc_client/ ./uc_server/\n")])])])]),s._v(" "),a("li",[a("p",[s._v("然后刷新界面")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://pic-onemue-cn.oss-cn-beijing.aliyuncs.com/docs/onemue16472499883HzUmW.png",alt:"image-20200415214757746"}})])]),s._v(" "),a("li",[a("p",[s._v("选择全新安装，点击下一步")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://pic-onemue-cn.oss-cn-beijing.aliyuncs.com/docs/onemue16472499962fhr47.png",alt:"image-20200415214822792"}})])]),s._v(" "),a("li",[a("p",[s._v("添加安装数据库有关信息必须要按照实际情况添加。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://pic-onemue-cn.oss-cn-beijing.aliyuncs.com/docs/onemue1647250002rjo8dN.png",alt:"image-20200415215149699"}})])]),s._v(" "),a("li",[a("p",[s._v("会开始安装论坛，安装完毕后就可以访问论坛了，可以把upload文件夹重命名")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" upload/ discuz\n")])])])])]),s._v(" "),a("p",[s._v("访问论坛")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://pic-onemue-cn.oss-cn-beijing.aliyuncs.com/docs/onemue1647250010od5uxN.png",alt:"image-20200415215539089"}})]),s._v(" "),a("h3",{attrs:{id:"_7-4-可以使用论坛管理员admin用户做论坛管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-4-可以使用论坛管理员admin用户做论坛管理"}},[s._v("#")]),s._v(" 7.4 可以使用论坛管理员admin用户做论坛管理")]),s._v(" "),a("p",[s._v("使用论坛管理员账号admin登录管理中心，就可以管理论坛了。")])])}),[],!1,null,null,null);t.default=e.exports}}]);